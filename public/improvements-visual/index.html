<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Toronto Collisions Map</title>

	<link href="https://fonts.googleapis.com/css2?family=Overpass:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			background-color: #0A6B4A;
			font-family: 'Overpass', sans-serif;
			overflow: hidden;
			height: 100vh;
			position: relative;
		}

		.title-section {
			position: absolute;
			top: 8%;
			left: 5%;
			right: 25%;
			z-index: 10;
		}

		.main-title {
			color: #FFFFFF;
			font-family: 'Overpass', sans-serif;
			font-weight: 700;
			font-size: 2.5rem;
			margin: 0;
			line-height: 1.2;
		}

		.description-section {
			position: absolute;
			top: 20%;
			left: 5%;
			right: 25%;
			z-index: 10;
			color: #FFFFFF;
			font-family: 'Overpass', sans-serif;
			font-weight: 400;
			font-size: 1.1rem;
			line-height: 1.6;
		}

		.filter-buttons {
			position: absolute;
			top: 8%;
			right: 2%;
			z-index: 10;
			display: flex;
			gap: 10px;
			align-items: center;
		}

		.tile-label {
			color: #FFFFFF;
			font-family: 'Overpass', sans-serif;
			font-weight: 400;
			font-size: 0.9rem;
		}

		.tile {
			background: #0A6B4A;
			border: 2px solid #FFFFFF;
			color: #FFFFFF;
			padding: 8px 16px;
			border-radius: 4px;
			font-family: 'Overpass', sans-serif;
			font-weight: 400;
			font-size: 0.9rem;
			cursor: pointer;
		}

		.tile.active {
			background: #FFFFFF;
			color: #0A6B4A;
		}

		.filter-dropdown-group {
			position: relative;
		}

		.filter-btn {
			background: #0A6B4A;
			border: 2px solid #FFFFFF;
			color: #FFFFFF;
			padding: 8px 16px;
			border-radius: 4px;
			font-family: 'Overpass', sans-serif;
			font-weight: 400;
			font-size: 0.9rem;
			cursor: pointer;
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.filter-btn:hover {
			background: #0C7B56;
		}

		.filter-btn::after {
			content: '▲';
			font-size: 0.7rem;
		}

		.filter-checkbox-container {
			position: absolute;
			top: 100%;
			right: 0;
			margin-top: 5px;
			background: #FFFFFF;
			border: 2px solid #0A6B4A;
			border-radius: 4px;
			padding: 10px;
			min-width: 200px;
			max-width: 250px;
			max-height: 300px;
			overflow-y: auto;
			display: none;
			z-index: 100;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
		}

		.filter-dropdown-group.active .filter-checkbox-container {
			display: block;
		}

		.filter-checkbox-item {
			display: flex;
			align-items: flex-start;
			gap: 8px;
			padding: 5px 0;
			color: #333333;
			font-family: 'Overpass', sans-serif;
			font-size: 0.9rem;
		}
		
		.filter-checkbox-item:hover {
			background-color: rgba(10, 107, 74, 0.05);
			border-radius: 2px;
		}

		.filter-checkbox-item input[type="checkbox"] {
			cursor: pointer;
			accent-color: #0A6B4A;
			margin-top: 2px;
		}

		.filter-checkbox-item label {
			display: flex;
			flex-direction: column;
			gap: 4px;
			cursor: pointer;
			user-select: none;
			color: #333333;
			flex: 1;
		}
		
		.improvement-text {
			font-size: 0.75rem;
			color: #666666;
			margin-left: 0;
			line-height: 1.3;
		}

		.chart-section {
			flex: 0 1 auto;
			max-width: 60%;
			padding: 100px 40px 40px 10%;
		}

		.description-section-viz {
			flex: 0 0 auto;
			padding: 100px 2rem 40px 0;
			margin-left: 1rem;
			max-width: 450px;
			overflow-wrap: break-word;
			word-wrap: break-word;
		}

		.main-content-wrapper {
			position: absolute;
			top: 13%;
			left: 5%;
			right: 3%;
			bottom: 12%;
			display: flex;
			flex-direction: column;
			padding: 0 !important;
			margin: 0 !important;
		}

		.content-top-section {
			display: flex;
			flex-direction: row;
			flex: 1;
			min-height: 0;
			gap: 0;
			overflow: hidden;
		}

		#mapDiv {
			flex: 2 2 auto;
			min-width: 0;
			display: block;
			padding: 20px;
			height: 100%;
			background: #FFFFFF;
			border-radius: 8px;
			overflow: hidden;
			position: relative;

		}

		#mapDiv svg {
			width: 100%;
			height: 100%;
			display: block;
		}

		#options-panel {
			flex: 0 0 35%;
			display: flex;
			flex-direction: column;
			align-items: flex-start;
			padding: 20px 2rem 20px 1rem;
			background: transparent;
			min-width: 0;
			overflow-wrap: break-word;
			word-wrap: break-word;
		}

		#options-panel h6 {
			color: #FFFFFF;
			font-family: 'Overpass', sans-serif;
			font-weight: 700;
			font-size: 1.5rem;
			margin-bottom: 20px;
		}

		#improvements-list {
			width: 100%;
			color: #FFFFFF;
			font-family: 'Overpass', sans-serif;
		}

		.improvement-item {
			margin-bottom: 30px;
		}

		.improvement-title {
			font-weight: 700;
			font-size: 1.2rem;
			margin-bottom: 8px;
			color: #FFFFFF;
		}

		.improvement-description {
			font-weight: 400;
			font-size: 1rem;
			line-height: 1.5;
			color: #FFFFFF;
		}

		.improvement-label {
			font-weight: 700;
			color: #FFFFFF;
		}

		.timeline-section {
			position: absolute;
			bottom: 1%;
			left: 5%;
			right: auto;
			width: auto;
			z-index: 10;
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: flex-start;
			gap: 20px;
			padding: 0;
			margin: 0;
			box-sizing: border-box;
			flex-shrink: 0;
		}

		.timeline-section > * {
			margin-left: 0 !important;
			margin-right: 0 !important;
		}

		#yearScrollContainer {
			flex: 0 0 auto;
			min-width: 0;
			max-width: 836px;
			margin: 0 !important;
			padding: 0 !important;
		}

		#yearScrollContainer svg {
			margin: 0 !important;
			padding: 0 !important;
		}

		.control-buttons {
			display: flex;
			gap: 10px;
			margin-top: -10px;
		}

		.play-button {
			background: #FFFFFF !important;
			border-radius: 50%;
			width: 50px;
			height: 50px;
			display: flex;
			align-items: center;
			justify-content: center;
			cursor: pointer;
		}

		.play-button .play-triangle {
			border-left: 15px solid #0A6B4A;
			border-top: 10px solid transparent;
			border-bottom: 10px solid transparent;
			margin-left: 3px;
		}

		.play-button.playing .play-triangle {
			margin-left: 0 !important;
			transform: translateX(-4px) !important;
			border-left: none;
		}

		.play-button.playing .play-triangle::before,
		.play-button.playing .play-triangle::after {
			content: '';
			position: absolute;
			width: 4px;
			height: 12px;
			background: #0A6B4A;
			border-radius: 2px;
		}

		.play-button.playing .play-triangle::before {
			left: 50%;
			transform: translateX(-6px) translateY(-50%);
			top: 50%;
		}

		.play-button.playing .play-triangle::after {
			left: 50%;
			transform: translateX(-2px) translateY(-50%);
			top: 50%;
		}

		.restart-button {
			background: transparent !important;
			color: #FFFFFF !important;
		}

		.restart-button svg {
			stroke: #FFFFFF !important;
		}
	</style>
</head>
<body>

<div class="title-section">
	<h1 class="main-title">How to Fix Roads for Pedestrians</h1>
</div>

<div class="description-section">
</div>

<div class="filter-buttons">
	<span class="tile-label">Filters</span>
	<div class="filter-dropdown-group" style="position: relative;">
		<button class="filter-btn" id="factors-filter-btn">
			<span>Factors</span>
		</button>
		<div class="filter-checkbox-container" id="factors-checkboxes">
			<div class="filter-checkbox-item">
				<input type="checkbox" id="factor-filter-inattentive" class="factor-checkbox" checked>
				<label for="factor-filter-inattentive">
					<span>Inattentive Driver</span>
					<div class="improvement-text">Possible improvement: Rumble Strips</div>
				</label>
			</div>
			<div class="filter-checkbox-item">
				<input type="checkbox" id="factor-filter-ice" class="factor-checkbox" checked>
				<label for="factor-filter-ice">
					<span>Ice</span>
					<div class="improvement-text">Possible improvement: Anti-icing Technology</div>
				</label>
			</div>
			<div class="filter-checkbox-item">
				<input type="checkbox" id="factor-filter-dark" class="factor-checkbox" checked>
				<label for="factor-filter-dark">
					<span>Dark</span>
					<div class="improvement-text">Possible improvement: Street Lighting</div>
				</label>
			</div>
			<div class="filter-checkbox-item">
				<input type="checkbox" id="factor-filter-speeding" class="factor-checkbox" checked>
				<label for="factor-filter-speeding">
					<span>Speeding</span>
					<div class="improvement-text">Possible improvement: Dynamic Speed Signs</div>
				</label>
			</div>
		</div>
	</div>
</div>

<div class="main-content-wrapper">
	<div class="content-top-section">
		<div id="mapDiv"></div>
		<div id="options-panel">
			<h6>Improvements</h6>
			<div id="improvements-list">
				<div class="improvement-item">
					<div class="improvement-title">
						<span class="improvement-label">1. Inattentive Driver → Rumble Strips</span>
					</div>
					<div class="improvement-description">
						<strong>How it works:</strong> Creates vibration and sound to alert distracted or drowsy drivers drifting out of their lane.
					</div>
				</div>
				<div class="improvement-item">
					<div class="improvement-title">
						<span class="improvement-label">2. Ice → Anti-icing Technology</span>
					</div>
					<div class="improvement-description">
						<strong>How it works:</strong> Proactively applying chemicals before a storm to prevent ice from bonding to the pavement.
					</div>
				</div>
				<div class="improvement-item">
					<div class="improvement-title">
						<span class="improvement-label">3. Dark → Street Lighting</span>
					</div>
					<div class="improvement-description">
						<strong>How it works:</strong> Increases visibility at intersections and highways, critical for spotting pedestrians who are disproportionately killed in dim light (59% of cases).
					</div>
				</div>
				<div class="improvement-item">
					<div class="improvement-title">
						<span class="improvement-label">4. Speeding → Dynamic Speed Signs</span>
					</div>
					<div class="improvement-description">
						<strong>How it works:</strong> Electronic signs that display real-time speed feedback to grab the driver's attention better than static signs.
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="timeline-section">
	<div id="yearScrollContainer"></div>
	<div class="control-buttons">
		<div class="play-button" id="playBtn">
			<div class="play-triangle"></div>
		</div>
		<div class="restart-button" id="restartBtn">
			<svg width="20" height="20" viewBox="0 0 20 20" fill="none">
				<path d="M17.5 2.5V7.5H12.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				<path d="M2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5C7.64367 2.5 5.50732 3.55357 4.0625 5.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</div>
	</div>
</div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="js/crashPointsVis.js"></script>
<script src="js/mapVis.js"></script>
<script src="../shared/js/yearScroll.js"></script>
<script src="../shared/js/playButton.js"></script>
<script src="js/improvementsVis.js"></script>
<script src="js/main.js"></script>


</body>
</html>
