<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Number of deaths across categories yearly</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Overpass:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/iframe-override.css">
    <style>
        body {
            background-color: #0A6B4A !important;
            margin: 0;
            padding: 0;
        }

        .infographic-container {
            width: 100%;
            height: 100vh;
            background-color: #0A6B4A;
            padding: 0 !important;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .title-section {
            position: absolute;
            top: 8%;
            left: 5%;
            z-index: 10;
        }

        .title-section h1.main-title {
            color: #FFFFFF !important;
            font-family: 'Overpass', sans-serif !important;
            font-weight: 700 !important;
            font-style: normal !important;
            display: flex;
            flex-direction: row;
            gap: 0.5rem;
            align-items: baseline;
        }

        .title-section .title-line-1 {
            font-size: 2.5rem;
            display: inline;
        }

        .title-section .title-line-2 {
            font-size: 2.5rem;
            display: inline;
        }

        /* Main content area */
        .main-content-wrapper {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 0 !important;
            margin: 0 !important;
            position: relative;
        }

        .content-top-section {
            display: flex;
            flex-direction: row;
            flex: 0 1 auto;
            min-height: 0;
            padding-top: 100px;
        }

        /* Left side - matrix chart */
        .rankings-container {
            flex: 1 1 auto;
            max-width: 44%;
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 3rem;
            padding: 40px 2% 40px 2%;
            min-height: 480px;
            max-height: 520px;
        }
        
        #bubbleChart {
            min-height: 480px;
            width: 100%;
            height: 100%;
        }

        .rank-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.9rem;
            flex: 1 1 160px;
            max-width: 200px;
        }

        .rank-label {
            color: #FFFFFF;
            font-family: 'Overpass', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .rank-sign {
            width: 90px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* 1st - Car: Yellow diamond */
        .rank-item:nth-child(1) .rank-sign {
            background: #FFD700;
            border: 4px solid #000;
            transform: rotate(45deg);
            border-radius: 8px;
        }

        .rank-item:nth-child(1) .rank-sign img {
            transform: rotate(-45deg);
            max-width: 50px;
            max-height: 50px;
        }

        /* 2nd - Pedestrian: White rectangular */
        .rank-item:nth-child(2) .rank-sign {
            background: #FFFFFF;
            border: 4px solid #000;
            border-radius: 4px;
        }

        .rank-item:nth-child(2) .rank-sign img {
            max-width: 55px;
            max-height: 55px;
        }

        /* 3rd - Bike: White square with green circle */
        .rank-item:nth-child(3) .rank-sign {
            background: #FFFFFF;
            border: 8px solid #0A6B4A;
            border-radius: 4px;
            position: relative;
        }

        .rank-item:nth-child(3) .rank-sign::before {
            content: '';
            position: absolute;
            width: 80px;
            height: 80px;
            border: 6px solid #0A6B4A;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .rank-item:nth-child(3) .rank-sign img {
            max-width: 50px;
            max-height: 50px;
            position: relative;
            z-index: 1;
        }

        .rank-name {
            color: #FFFFFF;
            font-family: 'Overpass', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        .rank-count {
            color: #FFFFFF;
            font-family: 'Overpass', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
        }

        /* Right side - description */
        .description-section {
            flex: 0 0 450px;
            display: flex;
            align-items: center;
            padding: 120px 2rem 40px 0;
            background: transparent;
            margin-left: 1rem;
            max-width: 450px;
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        .description-section p {
            color: #FFFFFF;
            font-family: 'Overpass', sans-serif;
            font-weight: 400;
            font-size: 1.1rem;
            line-height: 1.6;
            margin: 0;
            width: 100%;
            max-width: 100%;
        }

        /* Timeline at bottom - same as vehicle-visual */
        .timeline-section {
            position: relative;
            width: 100%;
            z-index: 10;
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 20px;
            padding: 20px 5%;
            margin-top: -20px;
            box-sizing: border-box;
            flex-shrink: 0;
        }

        .timeline-section svg {
            flex: 1;
            min-width: 0;
            max-width: 836px;
        }

        .timeline-section .year-label {
            fill: #FFFFFF !important;
            font-family: 'Overpass', sans-serif !important;
        }

        .control-buttons {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .play-button, .restart-button {
            background: #FFFFFF;
            border-radius: 6px;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            color: #0A6B4A;
        }

        .play-button:hover, .restart-button:hover {
            background: #F0F0F0;
            transform: scale(1.05);
        }

        .play-button.playing {
            background: #06D6A0;
            color: white;
        }

        .play-button .play-icon, .restart-button .restart-icon {
            font-size: 1rem;
        }

        #signChartContainer {
            display: none; /* Hide the old chart container */
        }

        #cardsRow {
            display: none; /* Hide the old cards */
        }
        
        /* Matrix tooltip */
        .matrix-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: #FFFFFF;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Overpass', sans-serif;
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .matrix-tooltip.visible {
            opacity: 1;
        }
        
        .matrix-tooltip strong {
            color: #FFFFFF;
        }

        @media (max-width: 1200px) {
            .rankings-container {
                max-width: 45%;
                gap: 2rem;
            }

            .description-section {
                flex: 0 0 400px;
                max-width: 400px;
            }
        }

        @media (max-width: 768px) {
            .content-top-section {
                flex-direction: column;
                padding-top: 80px;
            }

            .rankings-container {
                max-width: 100%;
                padding: 40px 20px;
                justify-content: center;
            }

            .description-section {
                flex: 1 1 auto;
                max-width: 100%;
                padding: 20px 2rem;
            }

            .timeline-section {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
                padding: 20px;
            }
        }

        @media (max-width: 700px) {
            .rankings-container {
                gap: 1.5rem;
            }

            .rank-item {
                flex: 1 1 130px;
            }
        }
    </style>
</head>
<body>

<div class="infographic-container">
    <div class="title-section">
        <h1 class="main-title">
            <span class="title-line-1">Vehicle Type Collision</span>
            <span class="title-line-2">Matrix</span>
        </h1>
    </div>

    <div class="main-content-wrapper">
        <div class="content-top-section">
            <!-- Left side - matrix chart -->
            <div class="rankings-container">
                <svg id="bubbleChart"></svg>
            </div>

            <!-- Right side - description -->
            <div class="description-section">
                <p>
                    This adjacency matrix visualizes collisions between different vehicle types, including cars, pedestrians, bikes, motorcycles, trucks, and transit vehicles. Each cell shows the number of unique collisions between the corresponding vehicle types, with colors ranging from green (low) to red (high) based on collision frequency. Use the interactive timeline to see how collision patterns change over the years and identify which vehicle type combinations are most dangerous. Hover over any cell to see detailed breakdowns by severity.
                </p>
            </div>
        </div>

        <!-- Timeline at bottom - same as vehicle-visual -->
        <div class="timeline-section">
            <div id="yearScrollContainer"></div>
            <!-- Play button -->
            <div class="control-buttons">
                <button class="play-button" id="playBtn" type="button">
                    <i class="fas fa-play play-icon"></i>
                </button>
                <button class="restart-button" id="restartBtn" type="button">
                    <i class="fas fa-redo restart-icon"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Hidden chart container for data updates -->
    <div id="signChartContainer" style="display: none;">
                <div class="row justify-content-center text-center mb-4" id="cardsRow">
                    <div class="col-4 col-md-2 d-flex justify-content-center">
                        <div class="category-card">
                            <div class="rank" id="bikeRank">1</div>
                            <img src="./svg/bike.svg" class="icon" alt="Bike">
                    <div class="count" id="bikeCountOld">0</div>
                            <div class="name">Bike</div>
                        </div>
                    </div>
                    <div class="col-4 col-md-2 d-flex justify-content-center">
                        <div class="category-card">
                            <div class="rank" id="carRank">2</div>
                            <img src="./svg/car.svg" class="icon" alt="Car">
                    <div class="count" id="carCountOld">0</div>
                            <div class="name">Car</div>
                        </div>
                    </div>
                    <div class="col-4 col-md-2 d-flex justify-content-center">
                        <div class="category-card">
                            <div class="rank" id="pedestrianRank">3</div>
                            <img src="./svg/pedestrian.svg" class="icon" alt="Pedestrian">
                    <div class="count" id="pedestrianCountOld">0</div>
                            <div class="name">Pedestrian</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Tooltip for matrix chart -->
<div id="matrixTooltip" class="matrix-tooltip"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="../shared/js/yearScroll.js"></script>
<script src="../shared/js/playButton.js"></script>
<script type="module" src="js/signChart.js"></script>


</body>
</html>

