<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Be Careful in the Evening</title>

    <!-- Load Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Overpass:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <style>
        /* Global font override - exclude Font Awesome icons */
        *:not(.fas):not(.fa):not(.far):not(.fal):not(.fab):not([class*="fa-"]):not(i) {
            font-family: 'Overpass', sans-serif !important;
        }

        body {
            font-family: 'Overpass', sans-serif !important;
        }

        /* Ensure Font Awesome icons use their own font */
        i[class*="fa-"],
        .fas,
        .far,
        .fal,
        .fab,
        .fa {
            font-family: "Font Awesome 6 Free" !important;
        }

        .infographic-container {
            background-color: #0A6B4A;
            min-height: 100vh;
            padding: 50px; /* Reduced padding */
        }

        .title-section {
            margin: 5px 30px 0px 30px; /* Reduced margins */
        }

        .main-title {
            color: #FFFFFF !important;
            font-family: 'Overpass', sans-serif !important;
            font-weight: 700 !important;
            font-size: 2rem;
            margin-bottom: 30px;
        }

        .description-section {
            color: #FFFFFF !important;
            font-family: 'Overpass', sans-serif !important;
            font-weight: 400 !important;
            font-size: 1rem !important; /* Reduced from 1.1rem */
            line-height: 1.5 !important; /* Reduced from 1.6 */
            max-width: 700px; /* Reduced from 800px */
            opacity: 0.9;
        }

        .description-section p {
            font-family: 'Overpass', sans-serif !important;
        }

        /* Time Visualization Styles */
        .time-visualization {
            margin: 20px 30px; /* Reduced margins */
        }

        .time-panels-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .time-panel {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px; /* Reduced from 12px */
            padding: 15px; /* Reduced from 20px */
            min-height: 250px; /* Reduced from 300px */
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .time-panel:hover {
            border-color: rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .panel-header {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
        }

        .info-icon {
            position: absolute;
            top: 0;
            left: 0;
            color: rgba(255, 255, 255, 0.7) !important;
            font-size: 1.1rem !important;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
            z-index: 10;
            display: inline-block !important;
            width: 1.1rem !important;
            height: 1.1rem !important;
            line-height: 1 !important;
        }

        .info-icon:hover {
            color: rgba(255, 255, 255, 1) !important;
            transform: scale(1.1);
        }

        /* Ensure Font Awesome icons display correctly */
        .info-icon.fas,
        .info-icon.fa-info-circle {
            font-family: "Font Awesome 6 Free" !important;
            font-weight: 900 !important;
        }

        .info-icon.fas::before,
        .info-icon.fa-info-circle::before {
            font-family: "Font Awesome 6 Free" !important;
            font-weight: 900 !important;
        }

        .time-label {
            font-size: 1.2rem;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 3px;
            font-family: 'Overpass', sans-serif !important;
        }

        .time-range {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            font-family: 'Overpass', sans-serif !important;
        }

        .bubbles-container {
            display: flex;
            flex-wrap: wrap;
            gap: 6px; /* Reduced spacing between dots */
            justify-content: center;
            align-content: flex-start;
            padding: 11px; /* Reduced from 15px */
        }

        .no-data-message {
            color: rgba(255, 255, 255, 0.7);
            font-family: 'Overpass', sans-serif !important;
            font-size: 0.9rem;
            text-align: center;
            padding: 20px;
            width: 100%;
        }


        /* Timeline Controls */
        .timeline-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: -20px; /* Reduced from -30px */
            padding: 15px; /* Reduced from 20px */
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px; /* Reduced from 12px */
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .control-buttons {
            display: flex;
            gap: 12px; /* Reduced from 15px */
            align-items: center;
        }

        .play-button, .restart-button {
            background: #FFFFFF;
            border-radius: 6px; /* Reduced from 8px */
            width: 45px; /* Reduced from 50px */
            height: 45px; /* Reduced from 50px */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            color: #0A6B4A;
        }

        .play-button:hover, .restart-button:hover {
            background: #F0F0F0;
            transform: scale(1.05);
        }

        .play-button.playing {
            background: #06D6A0;
            color: white;
        }

        .play-button .play-icon, .restart-button .restart-icon {
            font-size: 1rem; /* Reduced from 1.2rem */
        }

        .filter-dropdown-group {
            position: relative;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 8px 20px 8px 16px; /* Added right padding */
            color: #0A6B4A;
            font-weight: 600;
            cursor: pointer;
            outline: none;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-family: 'Overpass', sans-serif !important;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn:hover {
            border-color: rgba(255, 255, 255, 0.6);
            background: #FFFFFF;
        }

        .filter-btn::after {
            content: '▲';
            font-size: 0.7rem;
            color: #0A6B4A;
        }

        .filter-checkbox-container {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 5px;
            background: #FFFFFF;
            border: 2px solid #0A6B4A;
            border-radius: 4px;
            padding: 10px;
            min-width: 200px;
            max-width: 250px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .filter-dropdown-group.active .filter-checkbox-container {
            display: block;
        }

        .filter-checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 0;
            color: #333333;
            font-family: 'Overpass', sans-serif;
            font-size: 0.9rem;
        }

        .filter-checkbox-item:hover {
            background-color: rgba(10, 107, 74, 0.05);
            border-radius: 2px;
        }

        .filter-checkbox-item input[type="checkbox"] {
            cursor: pointer;
            accent-color: #0A6B4A;
        }

        .filter-checkbox-item label {
            cursor: pointer;
            user-select: none;
            color: #333333;
        }

        .tooltip {
            position: absolute;
            background: #FFFFFF;
            color: #000000;
            padding: 12px; /* Reduced from 15px */
            border-radius: 6px; /* Reduced from 8px */
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            max-width: 250px; /* Reduced from 300px */
            font-size: 0.85rem; /* Reduced from 0.9rem */
            line-height: 1.3; /* Reduced from 1.4 */
            border: none;
        }

        .tooltip.show {
            opacity: 1;
        }

        /* Time period tooltip */
        .time-period-tooltip {
            position: fixed;
            background: #FFFFFF;
            color: #000000;
            padding: 16px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease, transform 0.2s ease;
            z-index: 2000;
            min-width: 220px;
            max-width: 300px;
            font-family: 'Overpass', sans-serif;
            font-size: 0.9rem;
            line-height: 1.6;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transform: translateY(-10px);
        }

        .time-period-tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }

        .time-period-tooltip .tooltip-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #000000;
            border-bottom: 1px solid rgba(0, 0, 0, 0.2);
            padding-bottom: 6px;
            font-family: 'Overpass', sans-serif !important;
        }

        .time-period-tooltip .tooltip-stat {
            margin: 6px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Overpass', sans-serif !important;
        }

        .time-period-tooltip .tooltip-stat-label {
            color: rgba(0, 0, 0, 0.7);
            font-family: 'Overpass', sans-serif !important;
        }

        .time-period-tooltip .tooltip-stat-value {
            font-weight: 700;
            color: #000000;
            font-family: 'Overpass', sans-serif !important;
        }

        .time-period-tooltip .tooltip-severity {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(0, 0, 0, 0.2);
            font-family: 'Overpass', sans-serif !important;
        }

        .time-period-tooltip .tooltip-severity-item {
            display: flex;
            justify-content: space-between;
            margin: 4px 0;
            font-size: 0.85rem;
            font-family: 'Overpass', sans-serif !important;
        }

        /* Circle tooltip for individual collisions */
        .circle-tooltip {
            position: fixed;
            background: #FFFFFF;
            color: #000000;
            padding: 12px;
            border-radius: 6px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease, transform 0.2s ease;
            z-index: 3000;
            min-width: 200px;
            max-width: 280px;
            font-family: 'Overpass', sans-serif !important;
            font-size: 0.85rem;
            line-height: 1.5;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            transform: translateY(-5px);
        }

        .circle-tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }

        .circle-tooltip-title {
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 8px;
            color: #000000;
            border-bottom: 1px solid rgba(0, 0, 0, 0.2);
            padding-bottom: 4px;
            font-family: 'Overpass', sans-serif !important;
        }

        .circle-tooltip-item {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            font-family: 'Overpass', sans-serif !important;
        }

        .circle-tooltip-label {
            color: rgba(0, 0, 0, 0.7);
            font-weight: 500;
            margin-right: 10px;
            font-family: 'Overpass', sans-serif !important;
        }

        .circle-tooltip-value {
            font-weight: 600;
            color: #000000;
            text-align: right;
            flex-shrink: 0;
            font-family: 'Overpass', sans-serif !important;
        }

        /* Circle hover effect */
        .injury-circle {
            transition: transform 0.2s ease, box-shadow 0.2s ease !important;
        }

        /* Year Scroll Styles */
        .year-scroll-container {
            flex: 1;
            margin-right: 20px;
        }

        #yearScroller {
            width: 100%;
            height: 100px;
        }


        @keyframes bubbleAppear {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Responsive Design - Updated for smaller sizes */
        @media (max-width: 1024px) {
            .time-panels-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .time-panel {
                min-height: 220px;
            }

            .time-label {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 768px) {
            .time-panels-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .timeline-controls {
                flex-direction: column;
                gap: 8px;
                padding: 12px;
            }

            .title-section {
                margin: 15px;
            }

            .main-title {
                font-size: 1.8rem;
            }

            .description-section {
                font-size: 0.95rem;
            }

            .time-visualization {
                margin: 15px;
            }

            .year-scroll-container {
                margin-right: 0;
                margin-bottom: 12px;
                width: 100%;
            }

            #yearScroller {
                height: 70px;
            }

            .time-panel {
                min-height: 200px;
                padding: 12px;
            }

            .bubbles-container {
                gap: 4px; /* Smaller gap for mobile */
                padding: 8px;
            }

            .injury-circle {
                width: 5px !important;
                height: 5px !important;
            }
        }

        @media (max-width: 480px) {
            .infographic-container {
                padding: 10px;
            }

            .main-title {
                font-size: 1.5rem;
            }

            .time-label {
                font-size: 1rem;
            }

            .play-button, .restart-button {
                width: 40px;
                height: 40px;
            }

            .filter-dropdown select {
                padding: 6px 12px;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
<div class="infographic-container">
    <!-- Title Section -->
    <div class="title-section">
        <h1 class="main-title">Be Careful in the Evening</h1>
        <div class="description-section">
            <p style="margin-right: -320px; font-family: 'Overpass', sans-serif !important;">Use the year slider and time control to explore how injuries vary across different vehicle types throughout the day and over the years. Click on any vehicle circle to see detailed injury breakdown information. The size of each circle represents the relative number of injuries for that vehicle type during the selected time period.</p>
        </div>
    </div>

    <!-- Time-of-Day Visualization -->
    <div class="time-visualization">
        <!-- Four Time Period Panels -->
        <div class="time-panels-grid">
            <!-- Morning Panel -->
            <div class="time-panel" data-period="morning">
                <div class="panel-header">
                    <i class="fas fa-info-circle info-icon" data-period="morning"></i>
                    <div class="time-label">Morning</div>
                    <div class="time-range">5AM – 11AM</div>
                </div>
                <div class="bubbles-container" id="morning-bubbles">
                    <!-- Injury circles will be generated here -->
                </div>
            </div>

            <!-- Afternoon Panel -->
            <div class="time-panel" data-period="afternoon">
                <div class="panel-header">
                    <i class="fas fa-info-circle info-icon" data-period="afternoon"></i>
                    <div class="time-label">Afternoon</div>
                    <div class="time-range">11AM – 4PM</div>
                </div>
                <div class="bubbles-container" id="afternoon-bubbles">
                    <!-- Injury circles will be generated here -->
                </div>
            </div>

            <!-- Evening Panel -->
            <div class="time-panel" data-period="evening">
                <div class="panel-header">
                    <i class="fas fa-info-circle info-icon" data-period="evening"></i>
                    <div class="time-label">Evening</div>
                    <div class="time-range">4PM – 8PM</div>
                </div>
                <div class="bubbles-container" id="evening-bubbles">
                    <!-- Injury circles will be generated here -->
                </div>
            </div>

            <!-- Night Panel -->
            <div class="time-panel" data-period="night">
                <div class="panel-header">
                    <i class="fas fa-info-circle info-icon" data-period="night"></i>
                    <div class="time-label">Night</div>
                    <div class="time-range">8PM – 5AM</div>
                </div>
                <div class="bubbles-container" id="night-bubbles">
                    <!-- Injury circles will be generated here -->
                </div>
            </div>
        </div>

        <!-- Timeline Controls -->
        <div class="timeline-controls">
            <!-- YearScroll Container -->
            <div class="year-scroll-container">
                <div id="yearScroller"></div>
            </div>
            <div class="control-buttons">
                <button class="play-button" id="playBtn">
                    <i class="fas fa-play play-icon"></i>
                </button>
                <button class="restart-button" id="restartBtn">
                    <i class="fas fa-redo restart-icon"></i>
                </button>
                <!-- Severity Filter -->
                <div class="filter-dropdown-group">
                    <button class="filter-btn" id="severity-filter-btn">
                        <span>Severity</span>
                    </button>
                    <div class="filter-checkbox-container" id="severity-checkboxes">
                    </div>
                </div>

                <!-- District Filter -->
                <div class="filter-dropdown-group">
                    <button class="filter-btn" id="district-filter-btn">
                        <span>District</span>
                    </button>
                    <div class="filter-checkbox-container" id="district-checkboxes">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="tooltip" class="tooltip"></div>
<div id="timePeriodTooltip" class="time-period-tooltip"></div>

<!-- Load JS libraries -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="../shared/js/yearScroll.js"></script>
<script src="../shared/js/playButton.js"></script>
<script src="js/pedChart.js"></script>
<script src="js/main.js"></script>

</body>
</html>